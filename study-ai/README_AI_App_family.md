# 家庭族谱APP设计方案

## 目录

1. 功能概述
2. 数据结构设计
3. API接口设计
4. 界面设计建议
5. 技术栈建议

------

# 家庭族谱APP功能概述（详细版）

## 一、核心功能模块

### 1. 成员信息管理

**具体功能：**

- 成员档案创建
  - 基础信息：姓名、性别、出生日期、出生地
  - 扩展信息：职业、教育背景、联系方式（仅对授权用户可见）
  - 生命状态管理：在世/去世标记，去世成员自动生成享年计算
  - 多配偶关系支持（历史原因形成的复杂关系）
- 成员信息编辑
  - 时间轴式信息更新（保留历史修改记录）
  - 敏感信息修改权限控制（如直系亲属才可修改出生信息）
  - 批量导入/导出（支持GEDCOM标准格式）

**交互流程：**

```
用户点击"添加成员" → 选择添加方式（手动/导入） → 填写表单（带*为必填项） → 
系统自动校验数据合法性（如出生日期不能晚于死亡日期） → 保存后生成关系建议 →
提示"是否立即添加与现有成员的关系"
```

### 2. 家族关系管理

**具体功能：**

- 关系可视化编辑
  - 拖拽式关系建立（将成员B拖到成员A下方自动识别为父子关系）
  - 复杂关系支持：养子女、继父母、同父异母等特殊关系标注
  - 关系时间轴（可记录某段关系的起止时间，如婚姻存续期间）
- 关系验证系统
  - 自动检测关系矛盾（如出生日期早于父母结婚日期时提示）
  - 环形关系检测（防止出现A是B的父亲又是B的儿子的逻辑错误）

**交互流程：**

```
在家族树视图中长按成员 → 弹出操作菜单 → 选择"添加关系" → 
选择目标成员 → 选择关系类型 → 设置时间范围（可选） → 
系统校验关系合法性 → 生成双向关系记录
```

### 3. 家族树展示

**具体功能：**

- 多维度视图
  - 传统树状图（自上而下/自左向右布局）
  - 扇形展开图（以指定成员为中心辐射展示）
  - 时间轴视图（按出生年代排列）
- 智能布局
  - 自动避让算法（密集节点自动调整间距）
  - 焦点模式（双击成员快速聚焦其直系亲属）
  - 世代线标注（不同颜色区分不同辈分）

**交互流程：**

```
进入家族树 → 默认显示用户为中心的3代关系 → 
双指缩放控制显示范围 → 点击节点显示快速预览 → 
双击节点进入详情页 → 右上角切换视图模式
```

### 4. 家族大事记

**具体功能：**

- 事件分类系统
  - 生命周期事件（出生、结婚、去世等）
  - 家族里程碑（迁徙、置业、重大成就）
  - 年度聚会（自动生成年度相册时间线）
- 智能提醒
  - 生日提醒（提前1周通知相关成员）
  - 忌日提醒（按家族传统提前通知祭奠）
  - 纪念日循环提醒（每年结婚纪念日等）

**交互流程：```
在时间线视图点击"+" → 选择事件类型 → 填写事件详情 →
关联相关成员（自动建议可能的相关人） → 设置提醒规则 →
事件卡片生成（自动关联对应时期的家族照片）



```
## 二、扩展功能模块

### 1. 家族地理分布
**具体功能：**
- 迁徙路线图
  - 动态展示家族迁徙路径（结合时间轴播放）
  - 地域统计（生成"家族籍贯分布"热力图）

- 地理标记
  - 祖籍地标记载（支持上传老宅照片+GPS定位）
  - 墓地位置记录（支持扫墓路线导航）

### 2. 基因健康管理
**具体功能：**
- 健康档案
  - 遗传病史记录（加密存储，仅直系血亲可见）
  - 特征遗传标记（显性遗传特征如酒窝等）

- 分析工具
  - 姻亲血缘关系检测（避免近亲结婚风险）
  - 遗传病传播路径分析

### 3. 家族社交功能
**具体功能：**
- 权限管理系统
  - 分级查看权限（公开/家族成员/直系亲属三级）
  - 敏感信息水印（防止截图扩散）

- 协作功能
  - 信息补充悬赏（对模糊的老照片标注悬赏确认）
  - 线上家谱编修（多人协同编辑审核机制）

## 三、特殊场景处理

### 1. 敏感信息处理
- 隐私过滤器
  - 在世成员联系方式默认模糊显示
  - 非直系亲属不可查看详细住址
  - 争议关系标注（如离婚可设置是否显示）

### 2. 数据校验规则
- 时间矛盾检测
  - 子女出生日期必须晚于父母出生日期
  - 结婚日期必须晚于双方出生日期
- 生物学限制
  - 女性生育年龄限制（12-60岁之间）
  - 代际间隔合理范围（至少14年）

### 3. 多终端适配
- 打印优化
  - 家谱册导出（自动生成适合打印的竖版排布）
  - 祭祀用简化版家谱（仅显示男性后裔的传统模式）
- 移动端适配
  - 手势操作系统（左滑返回，右滑查看配偶）
  - 离线模式（支持无网络时查看最近查看的5代家谱）

## 四、用户流程示例

**典型使用场景：**
1. 新建家谱
```

注册账号 → 创建家族 → 添加自己作为初始成员 →
逐个添加直系亲属 → 邀请其他家庭成员加入协作



```
2. 补充历史信息
```

扫描老照片 → AI自动识别照片中人物 →
关联已有家族成员 → 补充拍摄时间和地点 →
生成带说明的电子相册

```
3. 关系查询
```

搜索"祖父的堂兄弟" → 系统展示准确成员 →
显示共同祖先路径图 → 导出关系证明文档



```
该设计方案涵盖了从基础信息管理到高级分析的全套功能，每个功能模块都考虑了实际使用场景和边缘情况处理。需要进一步细化某个模块时可以继续深入讨论。
```

### 5. 扩展功能

- 家族地理位置分布
- 家族基因/健康信息记录
- 家族活动组织
- 家族隐私权限管理

------

## 2. 数据结构设计

### 数据库表结构

#### 用户表(Users)

| 字段     | 类型           | 描述         |
| :------- | :------------- | :----------- |
| userId   | UUID           | 用户唯一标识 |
| username | String         | 用户名       |
| password | String(hashed) | 加密密码     |
| email    | String         | 电子邮箱     |
| phone    | String         | 手机号码     |

（其他表格以相同格式呈现）

------

## 3. API接口设计

### 3.1 用户认证

#### 注册接口

text



复制



下载

```
POST /api/auth/register
请求参数：
{
  "username": "String",
  "password": "String",
  "email": "String"
}

响应示例：
{
  "userId": "UUID",
  "token": "JWT令牌"
}
```

（其他接口以相同格式呈现）

### 3.2 家族树接口（树状结构）

text



复制



下载

```
GET /api/families/{familyId}/members/{memberId}/family-tree
响应结构：
{
  "rootMember": { /* 成员信息 */ },
  "tree": {
    "ancestors": { /* 祖先分支 */ },
    "descendants": { /* 后代分支 */ }
  }
}
```

------

## 4. 界面设计建议

### 主要界面原型

1. **家族树可视化界面**
   - 交互式树状图
   - 支持缩放和拖拽
   - 点击节点显示详情
2. **成员详情页**
   - 基本信息卡片
   - 关系网络图
   - 相关事件时间轴

------

## 5. 技术栈建议

| 层级 | 技术选项 |
| :--- | :------- |
|      |          |


